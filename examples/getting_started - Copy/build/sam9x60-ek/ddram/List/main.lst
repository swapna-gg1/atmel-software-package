###############################################################################
#
# IAR ANSI C/C++ Compiler V8.50.1.245/W32 for ARM         22/Jul/2020  11:19:50
# Copyright 1999-2020 IAR Systems AB.
#
#    Cpu mode                    
#    Endian                   =  little
#    Source file              =
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\main.c
#    Command line             =
#        -f C:\Users\c40450\AppData\Local\Temp\EW8FB1.tmp
#        (C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\main.c
#        -D "SOFTPACK_VERSION=\"2.17\"" -D TRACE_LEVEL=5 -D VARIANT_DDRAM -D
#        CONFIG_ARCH_ARMV5TE -D CONFIG_ARCH_ARM -D CONFIG_SOC_SAM9X60 -D
#        CONFIG_CHIP_SAM9X60 -D CONFIG_BOARD_SAM9X60_EK -D CONFIG_HAVE_AIC5 -D
#        CONFIG_HAVE_FLEXCOM -D CONFIG_HAVE_PIO3 -D CONFIG_HAVE_PIT -D
#        CONFIG_HAVE_SMC -D CONFIG_HAVE_SDRAMC -D CONFIG_HAVE_MPDDRC -D
#        CONFIG_HAVE_MPDDRC_DATA_PATH -D CONFIG_HAVE_MPDDRC_IO_CALIBRATION -D
#        CONFIG_HAVE_MPDDRC_DDR2 -D CONFIG_HAVE_ADC_LOW_RES -D
#        CONFIG_HAVE_PMC_FAST_STARTUP -D CONFIG_HAVE_PMC_GENERATED_CLOCKS -D
#        CONFIG_HAVE_SCKC -D CONFIG_HAVE_NFD0_ON_D16 -D CONFIG_HAVE_XDMAC -D
#        CONFIG_HAVE_PWMC -D CONFIG_HAVE_DDR2_W972GG6KB -D
#        CONFIG_HAVE_RSTC_EXTERNAL_RESET -D CONFIG_HAVE_RSTC_INDEPENDENT_RESET
#        -D CONFIG_HAVE_RTT -D CONFIG_HAVE_SHDWC -D CONFIG_HAVE_LED -D
#        CONFIG_HAVE_MMU -D CONFIG_HAVE_L1CACHE -D CONFIG_HAVE_OTPC -D
#        CONFIG_HAVE_DBGU -D CONFIG_HAVE_SERIALD_DBGU -D CONFIG_HAVE_USART -D
#        CONFIG_HAVE_USART_FIFO -D CONFIG_HAVE_DWDT --preprocess
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\build\sam9x60-ek\ddram\List
#        -lC
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\build\sam9x60-ek\ddram\List
#        --diag_suppress Pa050 -o
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\build\sam9x60-ek\ddram\Obj
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=ARM926EJ-S -e --fpu=None --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        8.4\arm\inc\c\DLib_Config_Normal.h" -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\arch\
#        -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\utils\
#        -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\target\common\
#        -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\target\sam9x60\
#        -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\drivers\
#        -I
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\..\..\lib\
#        --section .text=SOFTPACK --cpu_mode arm -On)
#    Locale                   =  C
#    List file                =
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\build\sam9x60-ek\ddram\List\main.lst
#    Object file              =
#        C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\build\sam9x60-ek\ddram\Obj\main.o
#    Runtime model:              
#      __SystemLibrary        =  DLib
#      __dlib_file_descriptor =  0
#      __dlib_version         =  6
#      __iar_require _Printf  =  int_specials
#
###############################################################################

C:\work\AtmelSoftPAck\atmel-software-package-2.17\examples\getting_started\main.c
      1          /* ----------------------------------------------------------------------------
      2           *         SAM Software Package License
      3           * ----------------------------------------------------------------------------
      4           * Copyright (c) 2015, Atmel Corporation
      5           *
      6           * All rights reserved.
      7           *
      8           * Redistribution and use in source and binary forms, with or without
      9           * modification, are permitted provided that the following conditions are met:
     10           *
     11           * - Redistributions of source code must retain the above copyright notice,
     12           * this list of conditions and the disclaimer below.
     13           *
     14           * Atmel's name may not be used to endorse or promote products derived from
     15           * this software without specific prior written permission.
     16           *
     17           * DISCLAIMER: THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR
     18           * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     19           * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
     20           * DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT, INDIRECT,
     21           * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
     22           * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
     23           * OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     24           * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     25           * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
     26           * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
     27           * ----------------------------------------------------------------------------
     28           */
     29          
     30          /**
     31           *  \page getting-started Getting Started with sama5d4x Microcontrollers
     32           *
     33           *  \section Purpose
     34           *
     35           *  The Getting Started example will help new users get familiar with Atmel's
     36           *  sama5d4x microcontroller. This basic application shows the startup
     37           *  sequence of a chip and how to use its core peripherals.
     38           *
     39           *  \section Requirements
     40           *
     41           *  This package can be used with SAMA5D4-EK and SAMA5D4-XULT.
     42           *
     43           *  \section Description
     44           *
     45           *  The demonstration program makes two LEDs on the board blink at a fixed rate.
     46           *  This rate is generated by using Time tick timer. The blinking can be stopped
     47           *  using two buttons (one for each LED). If there is no enough buttons on board, please
     48           *  type "1" or "2" in the terminal application on PC to control the LEDs
     49           *  instead.
     50           *
     51           *  \section Usage
     52           *
     53           *  -# Build the program and download it inside the evaluation board. Please
     54           *     refer to the
     55           *     <a href="http://www.atmel.com/dyn/resources/prod_documents/6421B.pdf">
     56           *     SAM-BA User Guide</a>, the
     57           *     <a href="http://www.atmel.com/dyn/resources/prod_documents/doc6310.pdf">
     58           *     GNU-Based Software Development</a>
     59           *     application note or to the
     60           *     <a href="ftp://ftp.iar.se/WWWfiles/arm/Guides/EWARM_UserGuide.ENU.pdf">
     61           *     IAR EWARM User Guide</a>,
     62           *     depending on your chosen solution.
     63           *  -# On the computer, open and configure a terminal application
     64           *     (e.g. HyperTerminal on Microsoft Windows) with these settings:
     65           *    - 115200 bauds
     66           *    - 8 bits of data
     67           *    - No parity
     68           *    - 1 stop bit
     69           *    - No flow control
     70           *  -# Start the application.
     71           *  -# Two LEDs should start blinking on the board. In the terminal window, the
     72           *     following text should appear (values depend on the board and chip used):
     73           *     \code
     74           *      -- Getting Started Example xxx --
     75           *      -- SAMxxxxx-xx
     76           *      -- Compiled: xxx xx xxxx xx:xx:xx --
     77           *     \endcode
     78           *  -# Pressing and release button 1 or type "1" in the terminal application on
     79           *     PC should make the first LED stop & restart blinking.
     80           *     Pressing and release button 2 or type "2" in the terminal application on
     81           *     PC should make the other LED stop & restart blinking.
     82           *
     83           *  \section References
     84           *  - getting-started/main.c
     85           *  - pio.h
     86           *  - pio_it.h
     87           *  - led.h
     88           *  - trace.h
     89           */
     90          
     91          /** \file
     92           *
     93           *  This file contains all the specific code for the getting-started example.
     94           *
     95           */
     96          
     97          /*----------------------------------------------------------------------------
     98           *        Headers
     99           *----------------------------------------------------------------------------*/
    100          
    101          #include "board.h"
    102          #include "chip.h"
    103          #include "trace.h"
    104          #include "compiler.h"
    105          #include "timer.h"
    106          
    107          #include "irq/irq.h"
    108          #include "gpio/pio.h"
    109          #include "peripherals/pmc.h"
    110          #include "peripherals/tcd.h"
    111          
    112          #include "serial/console.h"
    113          #include "led/led.h"
    114          
    115          
    116          #include <stdbool.h>
    117          #include <stdio.h>
    118          
    119          /*----------------------------------------------------------------------------
    120           *        Local definitions
    121           *----------------------------------------------------------------------------*/
    122          
    123          /** Delay for pushbutton debouncing (in milliseconds). */
    124          #define DEBOUNCE_TIME       500
    125          

   \                                 In section .data, align 4
    126          struct _tcd_desc tc = {
   \                     tc:
   \        0x0   0xF800'8000        DC32 0xf800'8000
   \        0x4   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00
   \       0x15   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00
   \       0x25   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00 0x00    

   \              0x00
    127          	.addr = TC0,
    128          	.channel = 0,
    129          };
    130          
    131          /*----------------------------------------------------------------------------
    132           *        Local variables
    133           *----------------------------------------------------------------------------*/
    134          
    135          
    136          #ifdef PINS_PUSHBUTTONS
    137          /** Pushbutton \#1 pin instance. */

   \                                 In section .rodata, align 4
    138          static const struct _pin button_pins[] = PINS_PUSHBUTTONS;
   \                     button_pins:
   \        0x0   0x03 0x00          DC8 3, 0, 0, 0

   \              0x00 0x00
   \        0x4   0x0004'0000        DC32 262'144
   \        0x8   0x07 0x00          DC8 7, 0, 0, 0

   \              0x00 0x00
   \        0xC   0x0000'0011        DC32 17
    139          #endif
    140          

   \                                 In section .bss, align 4
    141          volatile bool led_status[NUM_LEDS];
   \                     led_status:
   \        0x0                      DS8 4
    142          
    143          /*----------------------------------------------------------------------------
    144           *        Local functions
    145           *----------------------------------------------------------------------------*/
    146          
    147          /**
    148           *  \brief Process Buttons Events
    149           *
    150           *  Change active states of LEDs when corresponding button events happened.
    151           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    152          static void process_button_evt(uint8_t bt)
    153          {
   \                     process_button_evt:
   \        0x0   0xE92D'4010        PUSH     {R4,LR}
   \        0x4   0xE1B0'4000        MOVS     R4,R0
    154          	if (bt >= NUM_LEDS) {
   \        0x8   0xE1B0'0004        MOVS     R0,R4
   \        0xC   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x10   0xE350'0003        CMP      R0,#+3
   \       0x14   0xAA00'0028        BGE      ??process_button_evt_0
    155          		return;
    156          	}
    157          	led_status[bt] = !led_status[bt];
   \                     ??process_button_evt_1:
   \       0x18   0x....'....        LDR      R0,??DataTable5_2
   \       0x1C   0xE1B0'1004        MOVS     R1,R4
   \       0x20   0xE211'10FF        ANDS     R1,R1,#0xFF      ;; Zero extend
   \       0x24   0xE7D0'1001        LDRB     R1,[R0, +R1]
   \       0x28   0xE351'0000        CMP      R1,#+0
   \       0x2C   0x1A00'0001        BNE      ??process_button_evt_2
   \       0x30   0xE3A0'1001        MOV      R1,#+1
   \       0x34   0xEA00'0000        B        ??process_button_evt_3
   \                     ??process_button_evt_2:
   \       0x38   0xE3A0'1000        MOV      R1,#+0
   \                     ??process_button_evt_3:
   \       0x3C   0xE1B0'2004        MOVS     R2,R4
   \       0x40   0xE212'20FF        ANDS     R2,R2,#0xFF      ;; Zero extend
   \       0x44   0xE7C0'1002        STRB     R1,[R0, +R2]
    158          	if (bt == 0) {
   \       0x48   0xE1B0'1004        MOVS     R1,R4
   \       0x4C   0xE211'10FF        ANDS     R1,R1,#0xFF      ;; Zero extend
   \       0x50   0xE351'0000        CMP      R1,#+0
   \       0x54   0x1A00'0008        BNE      ??process_button_evt_4
    159          		if (!led_status[bt]) {
   \       0x58   0xE1B0'1004        MOVS     R1,R4
   \       0x5C   0xE211'10FF        ANDS     R1,R1,#0xFF      ;; Zero extend
   \       0x60   0xE7D0'0001        LDRB     R0,[R0, +R1]
   \       0x64   0xE350'0000        CMP      R0,#+0
   \       0x68   0x1A00'0013        BNE      ??process_button_evt_5
    160          			led_clear(bt);
   \       0x6C   0xE1B0'0004        MOVS     R0,R4
   \       0x70   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x74   0x....'....        BL       led_clear
   \       0x78   0xEA00'000F        B        ??process_button_evt_5
    161          		}
    162          	} else if (bt < NUM_LEDS) {
   \                     ??process_button_evt_4:
   \       0x7C   0xE1B0'1004        MOVS     R1,R4
   \       0x80   0xE211'10FF        ANDS     R1,R1,#0xFF      ;; Zero extend
   \       0x84   0xE351'0003        CMP      R1,#+3
   \       0x88   0xAA00'000B        BGE      ??process_button_evt_5
    163          		if (led_status[bt]) {
   \       0x8C   0xE1B0'1004        MOVS     R1,R4
   \       0x90   0xE211'10FF        ANDS     R1,R1,#0xFF      ;; Zero extend
   \       0x94   0xE7D0'0001        LDRB     R0,[R0, +R1]
   \       0x98   0xE350'0000        CMP      R0,#+0
   \       0x9C   0x0A00'0003        BEQ      ??process_button_evt_6
    164          			led_set(bt);
   \       0xA0   0xE1B0'0004        MOVS     R0,R4
   \       0xA4   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0xA8   0x....'....        BL       led_set
   \       0xAC   0xEA00'0002        B        ??process_button_evt_5
    165          		} else {
    166          			led_clear(bt);
   \                     ??process_button_evt_6:
   \       0xB0   0xE1B0'0004        MOVS     R0,R4
   \       0xB4   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0xB8   0x....'....        BL       led_clear
    167          		}
    168          	}
    169          }
   \                     ??process_button_evt_5:
   \                     ??process_button_evt_0:
   \       0xBC   0xE8BD'8010        POP      {R4,PC}          ;; return
    170          
    171          #ifdef PINS_PUSHBUTTONS
    172          
    173          /**
    174           *  \brief Handler for Buttons rising edge interrupt.
    175           *
    176           *  Handle process led1 status change.
    177           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    178          static void pio_handler(uint32_t group, uint32_t status, void* user_arg)
    179          {
   \                     pio_handler:
   \        0x0   0xE92D'40F8        PUSH     {R3-R7,LR}
   \        0x4   0xE1B0'4000        MOVS     R4,R0
   \        0x8   0xE1B0'5001        MOVS     R5,R1
   \        0xC   0xE1B0'6002        MOVS     R6,R2
    180          	int i;
    181          
    182          	/* unused */
    183          	(void)user_arg;
    184          
    185          	for (i = 0; i < ARRAY_SIZE(button_pins); ++i) {
   \       0x10   0xE3A0'7000        MOV      R7,#+0
   \                     ??pio_handler_0:
   \       0x14   0xE357'0000        CMP      R7,#+0
   \       0x18   0x1A00'000E        BNE      ??pio_handler_1
    186          		if (group != button_pins[i].group)
   \       0x1C   0x....'....        LDR      R0,??DataTable5_3
   \       0x20   0xE1B0'1207        LSLS     R1,R7,#+4
   \       0x24   0xE7D0'1001        LDRB     R1,[R0, +R1]
   \       0x28   0xE154'0001        CMP      R4,R1
   \       0x2C   0x1A00'0007        BNE      ??pio_handler_2
    187          			continue;
    188          		if (status & button_pins[i].mask)
   \                     ??pio_handler_3:
   \       0x30   0xE1B0'1207        LSLS     R1,R7,#+4
   \       0x34   0xE090'0001        ADDS     R0,R0,R1
   \       0x38   0xE590'0004        LDR      R0,[R0, #+4]
   \       0x3C   0xE110'0005        TST      R0,R5
   \       0x40   0x0A00'0002        BEQ      ??pio_handler_2
    189          			process_button_evt(i);
   \       0x44   0xE1B0'0007        MOVS     R0,R7
   \       0x48   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x4C   0x....'....        BL       process_button_evt
    190          	}
   \                     ??pio_handler_2:
   \       0x50   0xE297'7001        ADDS     R7,R7,#+1
   \       0x54   0xEAFF'FFEE        B        ??pio_handler_0
    191          }
   \                     ??pio_handler_1:
   \       0x58   0xE8BD'80F1        POP      {R0,R4-R7,PC}    ;; return
    192          
    193          /**
    194           *  \brief Configure the Pushbuttons
    195           *
    196           *  Configure the PIO as inputs and generate corresponding interrupt when
    197           *  pressed or released.
    198           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    199          static void configure_buttons(void)
    200          {
   \                     configure_buttons:
   \        0x0   0xE92D'4038        PUSH     {R3-R5,LR}
    201          	/* Adjust debounce filter parameters, use 10 Hz filter */
    202          	pio_set_debounce_filter(10);
   \        0x4   0xE3A0'000A        MOV      R0,#+10
   \        0x8   0x....'....        BL       pio_set_debounce_filter
    203          
    204          	int i = 0;
   \        0xC   0xE3A0'0000        MOV      R0,#+0
    205          	for (i = 0; i < ARRAY_SIZE(button_pins); ++i)
   \       0x10   0xE3A0'4000        MOV      R4,#+0
   \                     ??configure_buttons_0:
   \       0x14   0xE354'0000        CMP      R4,#+0
   \       0x18   0x1A00'0010        BNE      ??configure_buttons_1
    206          	{
    207          		/* Configure PIO */
    208          		pio_configure(&button_pins[i], 1);
   \       0x1C   0x....'....        LDR      R5,??DataTable5_3
   \       0x20   0xE3A0'1001        MOV      R1,#+1
   \       0x24   0xE1B0'0204        LSLS     R0,R4,#+4
   \       0x28   0xE095'0000        ADDS     R0,R5,R0
   \       0x2C   0x....'....        BL       pio_configure
    209          
    210          		/* Initialize interrupt with its handlers */
    211          		pio_add_handler_to_group(button_pins[i].group,
    212          				      button_pins[i].mask, pio_handler, NULL);
   \       0x30   0xE3A0'3000        MOV      R3,#+0
   \       0x34   0x....'....        ADR      R2,pio_handler
   \       0x38   0xE1B0'0204        LSLS     R0,R4,#+4
   \       0x3C   0xE095'0000        ADDS     R0,R5,R0
   \       0x40   0xE590'1004        LDR      R1,[R0, #+4]
   \       0x44   0xE1B0'0204        LSLS     R0,R4,#+4
   \       0x48   0xE7D5'0000        LDRB     R0,[R5, +R0]
   \       0x4C   0x....'....        BL       pio_add_handler_to_group
    213          
    214          		/* Enable interrupts */
    215          		pio_enable_it(button_pins);
   \       0x50   0xE1B0'0005        MOVS     R0,R5
   \       0x54   0x....'....        BL       pio_enable_it
    216          	}
   \       0x58   0xE294'4001        ADDS     R4,R4,#+1
   \       0x5C   0xEAFF'FFEC        B        ??configure_buttons_0
    217          }
   \                     ??configure_buttons_1:
   \       0x60   0xE8BD'8031        POP      {R0,R4,R5,PC}    ;; return
    218          
    219          #endif /* PINS_PUSHBUTTONS */
    220          
    221          #if NUM_LEDS > 1
    222          /**
    223           *  Interrupt handler for TC interrupt. Toggles the state of all LEDs except 0
    224           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    225          static int _tc_handler(void* arg, void* arg2)
    226          {
   \                     _tc_handler:
   \        0x0   0xE92D'4070        PUSH     {R4-R6,LR}
   \        0x4   0xE1B0'4000        MOVS     R4,R0
   \        0x8   0xE1B0'5001        MOVS     R5,R1
    227          	int i;
    228          
    229          	/** Toggle LEDs state. */
    230          	for (i = 1; i < NUM_LEDS; ++i) {
   \        0xC   0xE3A0'6001        MOV      R6,#+1
   \                     ??_tc_handler_0:
   \       0x10   0xE356'0003        CMP      R6,#+3
   \       0x14   0xAA00'000A        BGE      ??_tc_handler_1
    231          		if (led_status[i]) {
   \       0x18   0x....'....        LDR      R0,??DataTable5_2
   \       0x1C   0xE7D0'0006        LDRB     R0,[R0, +R6]
   \       0x20   0xE350'0000        CMP      R0,#+0
   \       0x24   0x0A00'0004        BEQ      ??_tc_handler_2
    232          			led_toggle(i);
   \       0x28   0xE1B0'0006        MOVS     R0,R6
   \       0x2C   0x....'....        BL       led_toggle
    233          			printf("%i ", (unsigned int)i);
   \       0x30   0xE1B0'1006        MOVS     R1,R6
   \       0x34   0x....'....        ADR      R0,??DataTable5  ;; "%i "
   \       0x38   0x....'....        BL       printf
    234          		}
    235          	}
   \                     ??_tc_handler_2:
   \       0x3C   0xE296'6001        ADDS     R6,R6,#+1
   \       0x40   0xEAFF'FFF2        B        ??_tc_handler_0
    236          
    237          	return 0;
   \                     ??_tc_handler_1:
   \       0x44   0xE3A0'0000        MOV      R0,#+0
   \       0x48   0xE8BD'8070        POP      {R4-R6,PC}       ;; return
    238          }
    239          
    240          #endif /* NUM_LEDS > 1 */
    241          
    242          /**
    243           *  \brief Handler for DBGU input.
    244           *
    245           *  Handle process LED1 or LED2 status change.
    246           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    247          static void console_handler(uint8_t key)
    248          {
   \                     console_handler:
   \        0x0   0xE92D'401C        PUSH     {R2-R4,LR}
   \        0x4   0xE1B0'4000        MOVS     R4,R0
    249          	if (key >= '0' && key <= '9') {
   \        0x8   0xE1B0'0004        MOVS     R0,R4
   \        0xC   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x10   0xE350'0030        CMP      R0,#+48
   \       0x14   0xBA00'0007        BLT      ??console_handler_0
   \       0x18   0xE1B0'0004        MOVS     R0,R4
   \       0x1C   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x20   0xE350'003A        CMP      R0,#+58
   \       0x24   0xAA00'0003        BGE      ??console_handler_0
    250          		process_button_evt(key - '0');
   \       0x28   0xE254'0030        SUBS     R0,R4,#+48
   \       0x2C   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x30   0x....'....        BL       process_button_evt
   \       0x34   0xEA00'0011        B        ??console_handler_1
    251          	}
    252          #if NUM_LEDS > 1
    253          	else if (key == 's') {
   \                     ??console_handler_0:
   \       0x38   0xE1B0'0004        MOVS     R0,R4
   \       0x3C   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x40   0xE350'0073        CMP      R0,#+115
   \       0x44   0x1A00'0002        BNE      ??console_handler_2
    254          		tcd_stop(&tc);
   \       0x48   0x....'....        LDR      R0,??DataTable5_4
   \       0x4C   0x....'....        BL       tcd_stop
   \       0x50   0xEA00'000A        B        ??console_handler_1
    255          	} else if (key == 'b') {
   \                     ??console_handler_2:
   \       0x54   0xE1B0'0004        MOVS     R0,R4
   \       0x58   0xE210'00FF        ANDS     R0,R0,#0xFF      ;; Zero extend
   \       0x5C   0xE350'0062        CMP      R0,#+98
   \       0x60   0x1A00'0006        BNE      ??console_handler_1
    256          		struct _callback _cb;
    257          
    258          		callback_set(&_cb, _tc_handler, NULL);
   \       0x64   0xE3A0'2000        MOV      R2,#+0
   \       0x68   0x....'....        ADR      R1,_tc_handler
   \       0x6C   0xE1B0'000D        MOVS     R0,SP
   \       0x70   0x....'....        BL       callback_set
    259          		tcd_start(&tc, &_cb);
   \       0x74   0xE1B0'100D        MOVS     R1,SP
   \       0x78   0x....'....        LDR      R0,??DataTable5_4
   \       0x7C   0x....'....        BL       tcd_start
    260          	}
    261          #endif
    262          }
   \                     ??console_handler_1:
   \       0x80   0xE8BD'8013        POP      {R0,R1,R4,PC}    ;; return
    263          
    264          /*----------------------------------------------------------------------------
    265           *        Global functions
    266           *----------------------------------------------------------------------------*/
    267          
    268          /**
    269           *  \brief getting-started Application entry point.
    270           *
    271           *  \return Unused (ANSI-C compatibility).
    272           */

   \                                 In section SOFTPACK, align 4, keep-with-next
    273          int main(void)
    274          {
   \                     main:
   \        0x0   0xE92D'4038        PUSH     {R3-R5,LR}
    275          	int i = 0;
   \        0x4   0xE3A0'0000        MOV      R0,#+0
    276          // none of these are
    277          
    278          	led_status[0] = true;
   \        0x8   0x....'....        LDR      R5,??DataTable5_2
   \        0xC   0xE3A0'1001        MOV      R1,#+1
   \       0x10   0xE5C5'1000        STRB     R1,[R5, #+0]
    279          	for (i = 1; i < NUM_LEDS; ++i) {
   \       0x14   0xE3A0'4001        MOV      R4,#+1
   \                     ??main_0:
   \       0x18   0xE354'0003        CMP      R4,#+3
   \       0x1C   0xAA00'0004        BGE      ??main_1
    280          		led_status[i] = led_status[i-1];
   \       0x20   0xE095'0004        ADDS     R0,R5,R4
   \       0x24   0xE550'0001        LDRB     R0,[R0, #-1]
   \       0x28   0xE7C5'0004        STRB     R0,[R5, +R4]
    281          	}
   \       0x2C   0xE294'4001        ADDS     R4,R4,#+1
   \       0x30   0xEAFF'FFF8        B        ??main_0
    282          
    283          	console_example_info("Getting Started Example");
   \                     ??main_1:
   \       0x34   0x....'....        LDR      R0,??DataTable5_5
   \       0x38   0x....'....        BL       console_example_info
    284          
    285          	printf("Initializing console interrupts\r\n");
   \       0x3C   0x....'....        LDR      R0,??DataTable5_6
   \       0x40   0x....'....        BL       printf
    286          	console_set_rx_handler(console_handler);
   \       0x44   0x....'....        ADR      R0,console_handler
   \       0x48   0x....'....        BL       console_set_rx_handler
    287          	console_enable_rx_interrupt();
   \       0x4C   0x....'....        BL       console_enable_rx_interrupt
    288          #ifdef PINS_PUSHBUTTONS
    289          	printf("Configure buttons with debouncing.\n\r");
   \       0x50   0x....'....        LDR      R0,??DataTable5_7
   \       0x54   0x....'....        BL       printf
    290          	configure_buttons();
   \       0x58   0x....'....        BL       configure_buttons
    291          	printf("Use push buttons or console key 0 to %d.\n\r", NUM_LEDS - 1);
   \       0x5C   0xE3A0'1002        MOV      R1,#+2
   \       0x60   0x....'....        LDR      R0,??DataTable5_8
   \       0x64   0x....'....        BL       printf
    292          #else
    293          	printf("Use console key 0 to %d.\n\r", NUM_LEDS - 1);
    294          #endif /* PINS_PUSHBUTTONS */
    295          
    296          	printf("Press the number of the led to make it "
    297          	       "start or stop blinking.\n\r");
   \       0x68   0x....'....        LDR      R0,??DataTable5_9
   \       0x6C   0x....'....        BL       printf
    298          
    299          	printf("LED 0 uses softpack timer functions\r\n");
   \       0x70   0x....'....        LDR      R0,??DataTable5_10
   \       0x74   0x....'....        BL       printf
    300          
    301          #if NUM_LEDS > 1
    302          	/* Configure TC */
    303          #if NUM_LEDS == 2
    304          	printf("LED 1 uses a TC\r\n");
    305          #else
    306          	printf("LEDs 1-%d use a TC\r\n", NUM_LEDS - 1);
   \       0x78   0xE3A0'1002        MOV      R1,#+2
   \       0x7C   0x....'....        LDR      R0,??DataTable5_11
   \       0x80   0x....'....        BL       printf
    307          #endif
    308          	printf("Press 's' to stop the TC and 'b' to start it\r\n");
   \       0x84   0x....'....        LDR      R0,??DataTable5_12
   \       0x88   0x....'....        BL       printf
    309          	tcd_configure_counter(&tc, 0, 4); /* 4Hz */
   \       0x8C   0xE3A0'2004        MOV      R2,#+4
   \       0x90   0xE3A0'1000        MOV      R1,#+0
   \       0x94   0x....'....        LDR      R0,??DataTable5_4
   \       0x98   0x....'....        BL       tcd_configure_counter
    310          #endif
    311          
    312          	while (1) {
    313          
    314          		/* Wait for LED to be active */
    315          		while (!led_status[0]);
   \                     ??main_2:
   \                     ??main_3:
   \       0x9C   0xE5D5'0000        LDRB     R0,[R5, #+0]
   \       0xA0   0xE350'0000        CMP      R0,#+0
   \       0xA4   0x0AFF'FFFC        BEQ      ??main_3
    316          
    317          		/* Toggle LED state if active */
    318          		if (led_status[0]) {
   \       0xA8   0xE5D5'0000        LDRB     R0,[R5, #+0]
   \       0xAC   0xE350'0000        CMP      R0,#+0
   \       0xB0   0x0A00'0003        BEQ      ??main_4
    319          			led_toggle(0);
   \       0xB4   0xE3A0'0000        MOV      R0,#+0
   \       0xB8   0x....'....        BL       led_toggle
    320          			printf("0 ");
   \       0xBC   0x....'....        ADR      R0,??DataTable5_1  ;; 0x30, 0x20, 0x00, 0x00
   \       0xC0   0x....'....        BL       printf
    321          		}
    322          
    323          		/* Wait for 250ms (4Hz) */
    324          		msleep(250);
   \                     ??main_4:
   \       0xC4   0xE3A0'00FA        MOV      R0,#+250
   \       0xC8   0x....'....        BL       msleep
   \       0xCC   0xEAFF'FFF2        B        ??main_2
    325          	}
    326          }

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5:
   \        0x0   0x25 0x69          DC8      "%i "

   \              0x20 0x00

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_1:
   \        0x0   0x30 0x20          DC8      0x30, 0x20, 0x00, 0x00

   \              0x00 0x00

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_2:
   \        0x0   0x....'....        DC32     led_status

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_3:
   \        0x0   0x....'....        DC32     button_pins

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_4:
   \        0x0   0x....'....        DC32     tc

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_5:
   \        0x0   0x....'....        DC32     ?_1

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_6:
   \        0x0   0x....'....        DC32     ?_2

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_7:
   \        0x0   0x....'....        DC32     ?_3

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_8:
   \        0x0   0x....'....        DC32     ?_4

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_9:
   \        0x0   0x....'....        DC32     ?_5

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_10:
   \        0x0   0x....'....        DC32     ?_6

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_11:
   \        0x0   0x....'....        DC32     ?_7

   \                                 In section SOFTPACK, align 4, keep-with-next
   \                     ??DataTable5_12:
   \        0x0   0x....'....        DC32     ?_8

   \                                 In section .rodata, align 4
   \        0x0   0x25 0x69          DC8 "%i "

   \              0x20 0x00

   \                                 In section .rodata, align 4
   \                     ?_1:
   \        0x0   0x47 0x65          DC8 "Getting Started Example"

   \              0x74 0x74    

   \              0x69 0x6E    

   \              0x67 0x20    

   \              0x53 0x74    

   \              0x61 0x72    

   \              0x74 0x65    

   \              0x64 0x20    

   \              0x45 0x78    

   \              0x61 0x6D    

   \              0x70 0x6C    

   \              0x65 0x00

   \                                 In section .rodata, align 4
   \                     ?_2:
   \        0x0   0x49 0x6E          DC8 "Initializing console interrupts\015\012"

   \              0x69 0x74    

   \              0x69 0x61    

   \              0x6C 0x69    

   \              0x7A 0x69    

   \              0x6E 0x67    

   \              0x20 0x63    

   \              0x6F 0x6E    

   \              0x73 0x6F    

   \              0x6C 0x65    

   \              0x20 0x69    

   \              0x6E 0x74    

   \              0x65 0x72    

   \              0x72 0x75    

   \              0x70 0x74    

   \              0x73 0x0D    

   \              0x0A 0x00
   \       0x22   0x00 0x00          DC8 0, 0

   \                                 In section .rodata, align 4
   \                     ?_3:
   \        0x0   0x43 0x6F          DC8 "Configure buttons with debouncing.\012\015"

   \              0x6E 0x66    

   \              0x69 0x67    

   \              0x75 0x72    

   \              0x65 0x20    

   \              0x62 0x75    

   \              0x74 0x74    

   \              0x6F 0x6E    

   \              0x73 0x20    

   \              0x77 0x69    

   \              0x74 0x68    

   \              0x20 0x64    

   \              0x65 0x62    

   \              0x6F 0x75    

   \              0x6E 0x63    

   \              0x69 0x6E    

   \              0x67 0x2E    

   \              0x0A 0x0D    

   \              0x00
   \       0x25   0x00 0x00          DC8 0, 0, 0

   \              0x00

   \                                 In section .rodata, align 4
   \                     ?_4:
   \        0x0   0x55 0x73          DC8 "Use push buttons or console key 0 to %d.\012\015"

   \              0x65 0x20    

   \              0x70 0x75    

   \              0x73 0x68    

   \              0x20 0x62    

   \              0x75 0x74    

   \              0x74 0x6F    

   \              0x6E 0x73    

   \              0x20 0x6F    

   \              0x72 0x20    

   \              0x63 0x6F    

   \              0x6E 0x73    

   \              0x6F 0x6C    

   \              0x65 0x20    

   \              0x6B 0x65    

   \              0x79 0x20    

   \              0x30 0x20    

   \              0x74 0x6F    

   \              0x20 0x25    

   \              0x64 0x2E    

   \              0x0A 0x0D    

   \              0x00
   \       0x2B   0x00               DC8 0

   \                                 In section .rodata, align 4
   \                     ?_5:
   \        0x0   0x50 0x72          DC8 0x50, 0x72, 0x65, 0x73, 0x73, 0x20, 0x74, 0x68

   \              0x65 0x73    

   \              0x73 0x20    

   \              0x74 0x68
   \        0x8   0x65 0x20          DC8 0x65, 0x20, 0x6E, 0x75, 0x6D, 0x62, 0x65, 0x72

   \              0x6E 0x75    

   \              0x6D 0x62    

   \              0x65 0x72
   \       0x10   0x20 0x6F          DC8 0x20, 0x6F, 0x66, 0x20, 0x74, 0x68, 0x65, 0x20

   \              0x66 0x20    

   \              0x74 0x68    

   \              0x65 0x20
   \       0x18   0x6C 0x65          DC8 0x6C, 0x65, 0x64, 0x20, 0x74, 0x6F, 0x20, 0x6D

   \              0x64 0x20    

   \              0x74 0x6F    

   \              0x20 0x6D
   \       0x20   0x61 0x6B          DC8 0x61, 0x6B, 0x65, 0x20, 0x69, 0x74, 0x20, 0x73

   \              0x65 0x20    

   \              0x69 0x74    

   \              0x20 0x73
   \       0x28   0x74 0x61          DC8 0x74, 0x61, 0x72, 0x74, 0x20, 0x6F, 0x72, 0x20

   \              0x72 0x74    

   \              0x20 0x6F    

   \              0x72 0x20
   \       0x30   0x73 0x74          DC8 0x73, 0x74, 0x6F, 0x70, 0x20, 0x62, 0x6C, 0x69

   \              0x6F 0x70    

   \              0x20 0x62    

   \              0x6C 0x69
   \       0x38   0x6E 0x6B          DC8 0x6E, 0x6B, 0x69, 0x6E, 0x67, 0x2E, 0x0A, 0x0D

   \              0x69 0x6E    

   \              0x67 0x2E    

   \              0x0A 0x0D
   \       0x40   0x00               DC8 0
   \       0x41   0x00 0x00          DC8 0, 0, 0

   \              0x00

   \                                 In section .rodata, align 4
   \                     ?_6:
   \        0x0   0x4C 0x45          DC8 "LED 0 uses softpack timer functions\015\012"

   \              0x44 0x20    

   \              0x30 0x20    

   \              0x75 0x73    

   \              0x65 0x73    

   \              0x20 0x73    

   \              0x6F 0x66    

   \              0x74 0x70    

   \              0x61 0x63    

   \              0x6B 0x20    

   \              0x74 0x69    

   \              0x6D 0x65    

   \              0x72 0x20    

   \              0x66 0x75    

   \              0x6E 0x63    

   \              0x74 0x69    

   \              0x6F 0x6E    

   \              0x73 0x0D    

   \              0x0A 0x00
   \       0x26   0x00 0x00          DC8 0, 0

   \                                 In section .rodata, align 4
   \                     ?_7:
   \        0x0   0x4C 0x45          DC8 "LEDs 1-%d use a TC\015\012"

   \              0x44 0x73    

   \              0x20 0x31    

   \              0x2D 0x25    

   \              0x64 0x20    

   \              0x75 0x73    

   \              0x65 0x20    

   \              0x61 0x20    

   \              0x54 0x43    

   \              0x0D 0x0A    

   \              0x00
   \       0x15   0x00 0x00          DC8 0, 0, 0

   \              0x00

   \                                 In section .rodata, align 4
   \                     ?_8:
   \        0x0   0x50 0x72          DC8 "Press 's' to stop the TC and 'b' to start it\015\012"

   \              0x65 0x73    

   \              0x73 0x20    

   \              0x27 0x73    

   \              0x27 0x20    

   \              0x74 0x6F    

   \              0x20 0x73    

   \              0x74 0x6F    

   \              0x70 0x20    

   \              0x74 0x68    

   \              0x65 0x20    

   \              0x54 0x43    

   \              0x20 0x61    

   \              0x6E 0x64    

   \              0x20 0x27    

   \              0x62 0x27    

   \              0x20 0x74    

   \              0x6F 0x20    

   \              0x73 0x74    

   \              0x61 0x72    

   \              0x74 0x20    

   \              0x69 0x74    

   \              0x0D 0x0A    

   \              0x00
   \       0x2F   0x00               DC8 0

   \                                 In section .rodata, align 4
   \        0x0   0x30 0x20          DC8 "0 "

   \              0x00
   \        0x3   0x00               DC8 0

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      16   _tc_handler
        16   -> led_toggle
        16   -> printf
      16   configure_buttons
        16   -> pio_add_handler_to_group
        16   -> pio_configure
        16   -> pio_enable_it
        16   -> pio_set_debounce_filter
      16   console_handler
        16   -> callback_set
        16   -> process_button_evt
        16   -> tcd_start
        16   -> tcd_stop
      16   main
        16   -> configure_buttons
        16   -> console_enable_rx_interrupt
        16   -> console_example_info
        16   -> console_set_rx_handler
        16   -> led_toggle
        16   -> msleep
        16   -> printf
        16   -> tcd_configure_counter
      24   pio_handler
        24   -> process_button_evt
       8   process_button_evt
         8   -> led_clear
         8   -> led_set


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable5
       4  ??DataTable5_1
       4  ??DataTable5_10
       4  ??DataTable5_11
       4  ??DataTable5_12
       4  ??DataTable5_2
       4  ??DataTable5_3
       4  ??DataTable5_4
       4  ??DataTable5_5
       4  ??DataTable5_6
       4  ??DataTable5_7
       4  ??DataTable5_8
       4  ??DataTable5_9
       4  ?_0
      24  ?_1
      36  ?_2
      40  ?_3
      44  ?_4
      68  ?_5
      40  ?_6
      24  ?_7
      48  ?_8
       4  ?_9
      76  _tc_handler
      16  button_pins
     100  configure_buttons
     132  console_handler
       4  led_status
     208  main
      92  pio_handler
     192  process_button_evt
      48  tc

 
   4 bytes in section .bss
  48 bytes in section .data
 348 bytes in section .rodata
 852 bytes in section SOFTPACK
 
 852 bytes of CODE  memory
 348 bytes of CONST memory
  52 bytes of DATA  memory

Errors: none
Warnings: none
